<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='/css/style.css') }}">
	<title>Подача заявки</title>
</head>
<body>
	<div class="header">
		<img src="{{ url_for('static', filename='imgs/logo.png') }}" class="logo_h_f">

		<a href="{{ url_for('index') }}" class="btns index_h_а">
			<img src="{{ url_for('static', filename='imgs/home.png') }}" class="ico_btn">
			На главную
		</a>

		<a href="./static/docs/Положение_ЖДП.pdf" target="_blank" class="btns polozhenie_h_f">
			<img src="{{ url_for('static', filename='imgs/polozhenie.png') }}" class="ico_btn">
			Положение
		</a>

	</div>

	<div class="main_bl_file">

		<form method="POST" enctype=multipart/form-data>
	 	<div class="page1" id="page1">
			<h3 class="title_form">Форма заявки</h3>
			<input type="text" name="title" class="title_inp perebor"  placeholder="Введите название работы">
			<span class="underline_title"></span>


			<div class="upload-container">
		        <input type="text" name='video_file' class="perebor" id="file_upload " value="" placeholder="Вставьте ссылку на ваше видео в ВК с конкурсным видео">
		    </div>
			<div>
				<span class="instruct_txt">Если ссылка будет некорректной (отличной от инструкции), то мы не получим Вашу работу!
				<br><br>
					ВНИМАТЕЛЬНО посмотрите инструкцию ниже:
				</span>
				<video src="{{url_for('static', filename='imgs/how_copy_link.mp4')}}" width="400px" controls></video>
			</div>
		    <textarea name="description" placeholder="Введите описание к вашему интервью..." class="description_ta perebor"></textarea>
			<div class="vozrast_cat">
				<span class="category_txt">Возрастная категория:</span>
				<input type="hidden" name="category" value="5">
				<input class="cat_check cc0" id="cat0" type="button" name="but1" value="10-15 лет" onclick='changeColor()'>

				<input class="cat_check cc1" id="cat1" type="button" name="but" value="16-18 лет" onclick='changeColor()'>
			</div>
			<div class="region_div">
				<label for="region" class="region_txt">Регион:</label>
		    	<input type="text" name="region" id="region" class="region_inp perebor">
			</div>
			<div class="nasel_punkt">
				<label for="locality" class="locality_txt">Населенный пункт:</label>
		    	<input type="text" name="city" id="locality" class="locality_inp perebor">
			</div>

		    <input type="text" name="e_institution" class="e_institution_inp perebor" placeholder='Образовательное учреждение'>

		    <input type="text" name="address" class="address_inp perebor" placeholder='Адрес образовательного учреждения'>

		    <input type="text" name="curator" class="curator_inp perebor" placeholder='ФИО куратора'>

		    <input type="tel" name="phone" class="phone_inp perebor" placeholder='Контактный телефон куратора'>

		    <input type="email" id ='email' name="email" class="email_inp perebor" placeholder='E-mail куратора'>

		    <input type="text" name="where_find" class="where_find_inp perebor" placeholder='Откуда вы узнали о конкурсе'>
			<img src="{{ url_for('static', filename='imgs/attention.png') }}" class="attention_ico1">

			<div class="attention_txt1">
				Пожалуйста, убедитесь что все введенные данные написаны правильно и страница с видео в ВК является ОТКРЫТОЙ, а затем нажмите на кнопку “Отправить”
			</div>
			<div id="next_page" class=" btn_nxt_pg">Далее</div>
		</div>

		<div class="page2" id="page2">
			<h3 class="title_form" id="t_vstr">Список участников</h3>

		    <div id="back_page" class=" btn_bck_pg">Назад</div>
			<img src="{{ url_for('static', filename='imgs/attention.png') }}" class="attention_ico">

		    <div class="attention_txt">Пожалуйста, убедитесь что все введенные данные написаны правильно и страница с видео в ВК является ОТКРЫТОЙ, а затем нажмите на кнопку “Отправить” <br>
			<br>
				Нажимая на кнопку "Отправить", вы даёте свое согласие на обработку персональных данных
			</div>

		    <input type="submit" value="Отправить" class="btns send_inp">
		    <img src="{{ url_for('static', filename='imgs/mail.png') }}" class="ico_btn_send">

		</div>

		</form>

	</div>

	<div class="footer">

		<img src="{{ url_for('static', filename='imgs/logo_kvant_w.png') }}" class="logo_f_kvant">
		<img src="{{ url_for('static', filename='imgs/rzd_logo.png') }}" class="logo_f_rzd">
		<div class="min_pros min_f">
			<img src="{{ url_for('static', filename='imgs/orel_logo_text.png') }}" class="logo_min">
			<p class="min_pros_txt">
				Конкурс включен в перечень, утвержденный Минпросвещение России на 2022/23 учебный год
			</p>
		</div>
		<div>
			<p class="vk_txt">
				Сообщество конкурса в Вконтакте
			</p>
			<a href="https://vk.com/event219650731"><img src="{{ url_for('static', filename='imgs/vk_logo.png' )}}" class="logo_vk"></a>
		</div>
	</div>
	<script>
		let btn_btn_next = document.getElementById('next_page');
		let btn_btn_back = document.getElementById('back_page');

		//let pereb_inp = document.getElementsByClassName('perebor');
		//for (let i=0; i<pereb_inp.length; i++){
		//	pereb_inp[i].addEventListener("change", pereb_check)
		//}


		btn_btn_next.addEventListener("click",zz)


		btn_btn_back.addEventListener("click",bb)




		// anhor_video.addEventListener("change", check_anhor)


		function check_email(elem){
			let reg_exp_email = /^(([^<>()[\].,;:\s@"]+(\.[^<>()[\].,;:\s@"]+)*)|(".+"))@(([^<>()[\].,;:\s@"]+\.)+[^<>()[\].,;:\s@"]{2,})$/iu
			if ( !reg_exp_email.test(elem.value)){
				elem.classList.add('emtpy_border')
				return false
			}
			else{
				elem.classList.remove('emtpy_border')
				return true
			}
		}

		function check_anhor(elem){
			let reg_e = /^https:\/\/vk.com\/.*$/

			if ( !reg_e.test(elem.value)){
				elem.classList.add('emtpy_border')
				return false
			}
			else{
				elem.classList.remove('emtpy_border')
				return true
			}
		}

		function zz(e){
			let pereb_inp = document.getElementsByClassName('perebor');
			let next_flag = 1
			for (let i=0; i<pereb_inp.length; i++){

				if (pereb_inp[i].value == ''){

					pereb_inp[i].classList.add('emtpy_border')
					next_flag = 0
				}
				else{
					pereb_inp[i].classList.remove('emtpy_border')
				}
			}
			let category0 = document.getElementById('cat0');
			let category1 = document.getElementById('cat1');
			var submits = document.getElementsByName("category");
			// console.log(submits[0].value !='0' && submits[0].value !='1')

			if (submits[0].value !='0' && submits[0].value !='1'){
				next_flag = 0
				category0.classList.add('emtpy_border')
				category1.classList.add('emtpy_border')
			}
			else{

				category0.classList.remove('emtpy_border')
				category1.classList.remove('emtpy_border')

			}
			let anhor_video = document.getElementById('file_upload ')
			if (!check_anhor(anhor_video)){
				next_flag = 0
			}
			let email_div = document.getElementById('email')
			if (!check_email(email_div)){
				next_flag = 0
			}
			if (next_flag ==1){
				let btn_next = document.getElementById('page1');
				btn_next.style.zIndex = "0";
			}

		}
		function bb(e){
		let btn_next = document.getElementById('page1');
		btn_next.style.zIndex = "5";
		}

		function ss(e) {
	        e.target.style.color='black'
	    }

		function uploadFiles() {

	        var files = document.getElementById('file_upload').files;
	        if(files.length==0){
	            alert("Please first choose or drop any file(s)...");
	            return;
	        }
	        var filenames="";
	        for(var i=0;i<files.length;i++){
	            filenames+=files[i].name+"\n";
	        }
	    }


		
		let flagg = 0
		function changeColor(e) {
			
			var submits = document.getElementsByName("category");
			
			var sender = (e && e.target) || (window.event && window.event.srcElement);

			if (sender.name == 'but1'){
				
				document.getElementById('cat0').style.backgroundColor = 'red';
				document.getElementById('cat0').style.color= 'white';
				document.getElementById('cat1').style.backgroundColor = '';
				document.getElementById('cat1').style.color= 'black';
				submits[0].value='0';
				let test = document.getElementsByName('category')[0].value;
				let page_two = document.getElementById('page2')
				let h3_vstr = document.getElementById('back_page');
				let div_uchast = document.createElement('div');
				div_uchast.setAttribute('id',"div_categ0")
				if (document.getElementById('div_categ1')!=null ){
					document.getElementById('div_categ1').remove()
				}
				if (flagg!=1){
					for (let i=5; i>0;i--){
						let inp_fio0 = document.createElement('input');
						inp_fio0.className = "participants_inp";
						inp_fio0.setAttribute('name',`participants${i}`)
						inp_fio0.setAttribute('type',"text")
						inp_fio0.setAttribute('id',"fio_uch")
						inp_fio0.setAttribute('placeholder',`ФИО ${i}-ого участника`)
						let div_dr = document.createElement('div')
						div_dr.setAttribute("class","dr_div")
						let opis_dr = document.createElement('label')
						opis_dr.setAttribute("for","fio_uch")
						opis_dr.setAttribute("class","dr_opis")
						opis_dr.innerHTML = 'Дата рождения:'
						let inp_dr0 = document.createElement('input');
						inp_dr0.className = "participants_date";
						inp_dr0.setAttribute('name',`date_participants${i}`)
						inp_dr0.setAttribute('type',"date")
						inp_dr0.addEventListener("change", ss)


						h3_vstr.after(div_uchast);
						div_uchast.prepend(inp_fio0)
						inp_fio0.after(div_dr);
						div_dr.append(opis_dr);
						div_dr.append(inp_dr0);
					}
					flagg=1
				}
			}
			else if(sender.name == 'but'){
				submits[0].value='1';
				document.getElementById('cat1').style.backgroundColor = 'red';
				document.getElementById('cat1').style.color= 'white';
				document.getElementById('cat0').style.backgroundColor = '';
				document.getElementById('cat0').style.color= 'black';
				let test = document.getElementsByName('category')[0].value;
				let page_two = document.getElementById('page2');
				let h3_vstr = document.getElementById('back_page');
				let div_uchast = document.createElement('div');
				div_uchast.setAttribute('id',"div_categ1")
				if (document.getElementById('div_categ0')!=null){
					document.getElementById('div_categ0').remove()
				}
				if (flagg!=2){
					for (let i=3; i>0;i--){
						let inp_fio1 = document.createElement('input');
						inp_fio1.className = "participants_inp";
						inp_fio1.setAttribute('name',`participants${i}`)
						inp_fio1.setAttribute('type',"text")
						inp_fio1.setAttribute('id',"fio_uch")
						inp_fio1.setAttribute('placeholder',`ФИО ${i}-ого участника`)
						let div_dr = document.createElement('div')
						div_dr.setAttribute("class","dr_div")
						let opis_dr = document.createElement('label')
						opis_dr.setAttribute("for","fio_uch")
						opis_dr.setAttribute("class","dr_opis")
						opis_dr.innerHTML = 'Дата рождения:'
						let inp_dr1 = document.createElement('input');
						inp_dr1.className = "participants_date";
						inp_dr1.setAttribute('name',`date_participants${i}`)
						inp_dr1.setAttribute('type',"date")
						inp_dr1.addEventListener("change", ss)


						h3_vstr.after(div_uchast);
						div_uchast.prepend(inp_fio1)
						inp_fio1.after(div_dr);
						div_dr.append(opis_dr);
						div_dr.append(inp_dr1);
					}
					flagg =2
				}
				}

		}

	</script>
</body>
</html>
